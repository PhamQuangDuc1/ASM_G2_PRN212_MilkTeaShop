<Window x:Class="MilkTeaShop_Hantu.OrderWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MilkTeaShop_Hantu"
        mc:Ignorable="d"
        Title="Chọn sản phẩm"
        Height="600" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource PrimaryBackgroundBrush}">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="300"/>
        </Grid.ColumnDefinitions>

        <!-- DANH MỤC -->
        <StackPanel Grid.Column="0" Margin="10">
            <!-- Logo Blue Sky Tea Milk -->
            <Border Background="White" CornerRadius="8" Margin="0,0,0,10" Padding="10">
                <Border.Effect>
                    <DropShadowEffect Color="Black" Direction="320" ShadowDepth="2" Opacity="0.15" BlurRadius="4"/>
                </Border.Effect>
                <Image x:Name="CategoryLogoImage" 
                       Width="160" Height="80" 
                       Stretch="Uniform" HorizontalAlignment="Center"/>
            </Border>

            <TextBlock Text="📋 Danh mục" FontSize="18" FontWeight="Bold" Margin="0,0,0,10" 
                      Foreground="#2D3748"/>

            <!-- Category Container với ScrollViewer -->
            <Border Background="#F7FAFC" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1" Padding="5">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Height="450">
                    <StackPanel x:Name="CategoryPanel" Margin="5"/>
                </ScrollViewer>
            </Border>
        </StackPanel>

        <!-- DANH SÁCH SẢN PHẨM -->
        <Grid Grid.Column="1" Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Thanh tìm kiếm -->
            <Grid Grid.Row="0" Margin="0,0,0,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="300"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox x:Name="SearchBox" Width="300" Padding="8,0"
                         FontSize="14" VerticalContentAlignment="Center" TextChanged="SearchBox_TextChanged" Margin="0,-14,0,0"/>
                <Button Grid.Column="1" Content="Tìm kiếm" Width="100" Margin="10,-14,0,0"
                        Background="#FF2196F3" Foreground="White" FontWeight="Bold" Click="SearchButton_Click"/>
            </Grid>

            <!-- Danh sách sản phẩm -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                <WrapPanel x:Name="ProductPanel" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="5"/>
            </ScrollViewer>

            <!-- Thanh phân trang -->
            <Grid Grid.Row="2" Margin="0,10,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Thông tin trang và nút Tất cả -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock x:Name="PageInfoText" Text="Trang 1/1" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <Button x:Name="ShowAllButton" Content="📋 Tất cả" Width="105" Height="50" 
                            Background="#FF9C27B0" Foreground="White" FontWeight="Bold"
                            Click="ShowAllButton_Click" Margin="0,0,10,0"/>
                </StackPanel>

                <!-- Nút điều hướng trang -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="PrevPageButton" Content="◀ Trước" Width="87" Height="42" 
                            Background="#FF607D8B" Foreground="White" FontWeight="Bold"
                            Click="PrevPageButton_Click" Margin="0,0,5,0"/>
                    <Button x:Name="NextPageButton" Content="Sau ▶" Width="80" Height="44" 
                            Background="#FF607D8B" Foreground="White" FontWeight="Bold"
                            Click="NextPageButton_Click" Margin="5,0,0,0"/>
                </StackPanel>
                <Button Grid.Column="1" x:Name="productView" Content="Product view" HorizontalAlignment="Left" Height="50" Margin="30,0,0,0" VerticalAlignment="Center" Width="121" Click="productView_Click"/>
            </Grid>
        </Grid>

        <!-- MỤC THANH TOÁN -->
        <Border Grid.Column="2" Margin="10" Padding="10" CornerRadius="8"
                BorderBrush="#DDD" BorderThickness="1" Background="White">
            <Border.Effect>
                <DropShadowEffect Color="Black" Direction="320" ShadowDepth="4" Opacity="0.3" BlurRadius="8"/>
            </Border.Effect>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Tiêu đề -->
                <TextBlock Grid.Row="0" Text="🧾 Mục thanh toán" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>

                <!-- Danh sách giỏ hàng -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="0,0,0,10">
                    <ListView x:Name="CartList" BorderBrush="#CCC" BorderThickness="1" MouseDoubleClick="CartList_MouseDoubleClick">

                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Tên món" Width="150" DisplayMemberBinding="{Binding ProductName}" />
                                <GridViewColumn Header="Size" Width="80" DisplayMemberBinding="{Binding SizeName}" />
                                <GridViewColumn Header="Topping" Width="150">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <ItemsControl ItemsSource="{Binding SelectedToppings}" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Header="SL" Width="80">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Content="−" Width="20" Height="20" Click="DecreaseQuantity_Click" CommandParameter="{Binding}" />
                                                <TextBlock Text="{Binding Quantity}" Width="25" TextAlignment="Center" VerticalAlignment="Center" Margin="5,0" />
                                                <Button Content="+" Width="20" Height="20" Click="IncreaseQuantity_Click" CommandParameter="{Binding}" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn Header="Giá" Width="70" DisplayMemberBinding="{Binding UnitPrice}" />
                                <GridViewColumn Header="">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button Content="X" Background="Red" Foreground="White" FontWeight="Bold"
                                                    Width="25" Height="25" CommandParameter="{Binding}" Click="RemoveFromCart_Click"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView>
                </ScrollViewer>

                <!-- Tổng cộng + nút thanh toán -->
                <StackPanel Grid.Row="2" Margin="0,10,0,0">
                    <Separator Margin="0,5"/>
                    <TextBlock x:Name="TotalText" FontSize="16" FontWeight="Bold" Margin="0,10,0,10" Text="Tổng cộng: 0đ"/>
                    <Button Content="💰 Thanh toán" Height="40" Background="#FF4CAF50" Foreground="White" FontWeight="Bold"
                            Click="Checkout_Click"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
